# 第05章：字符串详解

字符串（String）是Python中最常用的数据类型之一，用来处理文本。

## 创建字符串

### 单引号和双引号

```python
# 单引号
name = 'Python'

# 双引号
message = "Hello, World!"

# 两者完全一样，选一个用就行
# 建议：字符串里有单引号用双引号包，反之亦然
text1 = "I'm a student"  # 字符串里有单引号
text2 = 'He said "Hello"'  # 字符串里有双引号
```

### 三引号（多行字符串）

```python
# 三个单引号或三个双引号
poem = '''
床前明月光，
疑是地上霜。
举头望明月，
低头思故乡。
'''

doc = """
这是多行字符串
可以写很多行
保留所有格式
"""
```

### 转义字符

```python
# \n 换行
print("第一行\n第二行")

# \t 制表符(Tab)
print("姓名\t年龄\t城市")
print("张三\t18\t北京")

# \\ 反斜杠
print("C:\\Users\\Desktop")

# \' 和 \" 引号
print("He said \"Hello\"")
print('I\'m happy')

# \r 回车
# \b 退格
# \0 空字符
```

### 原始字符串

```python
# 前面加r，不转义
path = r"C:\new\test.txt"  # \n不会被转义成换行
print(path)  # C:\new\test.txt

# 正则表达式常用
pattern = r"\d+\.\d+"  # 匹配小数
```

## 字符串操作

### 拼接

```python
# 用 + 拼接
first_name = "张"
last_name = "三"
full_name = first_name + last_name
print(full_name)  # 张三

# 用 * 重复
laugh = "哈" * 5
print(laugh)  # 哈哈哈哈哈

# 不同类型不能直接拼接
age = 18
# message = "我今年" + age + "岁"  # TypeError!
message = "我今年" + str(age) + "岁"  # 正确
```

### 格式化

#### f-string（推荐！）

```python
name = "小明"
age = 18
score = 95.5

# 直接在{}里写变量
message = f"我叫{name}，今年{age}岁，考了{score}分"
print(message)

# 可以写表达式
print(f"明年我{age + 1}岁")
print(f"平均分：{(90 + 95 + 88) / 3:.2f}")

# 对齐和填充
print(f"|{name:10}|")    # 左对齐，宽度10
print(f"|{name:<10}|")   # 左对齐
print(f"|{name:>10}|")   # 右对齐
print(f"|{name:^10}|")   # 居中
print(f"|{name:*^10}|")  # 用*填充
```

#### format()方法

```python
# 按位置
text = "我叫{}，今年{}岁".format("小红", 18)

# 指定位置
text = "我叫{0}，今年{1}岁，{0}很高兴".format("小红", 18)

# 指定名称
text = "我叫{name}，今年{age}岁".format(name="小红", age=18)
```

#### %格式化（老方法）

```python
name = "小明"
age = 18
score = 95.5

# %s 字符串，%d 整数，%f 浮点数
text = "我叫%s，今年%d岁，考了%.1f分" % (name, age, score)
print(text)
```

## 索引和切片

### 索引（单个字符）

```python
text = "Python"

# 正向索引（从0开始）
print(text[0])  # P
print(text[1])  # y
print(text[5])  # n

# 反向索引（从-1开始）
print(text[-1])  # n（最后一个）
print(text[-2])  # o
print(text[-6])  # P（第一个）

# 越界会报错
# print(text[10])  # IndexError
```

### 切片（多个字符）

```python
text = "Hello, World!"

# [起始:结束]（不包括结束位置）
print(text[0:5])    # Hello
print(text[7:12])   # World

# 省略起始（从头开始）
print(text[:5])     # Hello

# 省略结束（到末尾）
print(text[7:])     # World!

# 全部
print(text[:])      # Hello, World!

# 步长
print(text[0:10:2]) # Hlo o（每隔2个取一个）
print(text[::2])    # Hlo ol!

# 反转字符串（步长为-1）
print(text[::-1])   # !dlroW ,olleH
```

### 切片技巧

```python
text = "Python Programming"

# 取前5个字符
print(text[:5])     # Pytho

# 取后5个字符
print(text[-5:])    # mming

# 去掉第一个和最后一个
print(text[1:-1])   # ython Programmin

# 反转
print(text[::-1])   # gnimmargorP nohtyP
```

## 字符串方法

### 大小写转换

```python
text = "Hello World"

print(text.upper())       # HELLO WORLD（全大写）
print(text.lower())       # hello world（全小写）
print(text.capitalize())  # Hello world（首字母大写）
print(text.title())       # Hello World（每个单词首字母大写）
print(text.swapcase())    # hELLO wORLD（大小写互换）
```

### 查找和替换

```python
text = "Hello, World! Hello, Python!"

# 查找
print(text.find("World"))      # 7（首次出现的位置）
print(text.find("Java"))       # -1（没找到）
print(text.index("World"))     # 7（和find类似，但找不到会报错）

# 计数
print(text.count("Hello"))     # 2（出现2次）

# 替换
new_text = text.replace("Hello", "Hi")
print(new_text)  # Hi, World! Hi, Python!

# 替换指定次数
new_text = text.replace("Hello", "Hi", 1)  # 只替换第一个
print(new_text)  # Hi, World! Hello, Python!
```

### 判断

```python
# 开头和结尾
text = "hello.py"
print(text.startswith("hello"))  # True
print(text.endswith(".py"))      # True

# 包含
print("llo" in text)    # True
print("abc" in text)    # False
print("abc" not in text)  # True

# 字符类型判断
print("123".isdigit())     # True（全是数字）
print("abc".isalpha())     # True（全是字母）
print("abc123".isalnum())  # True（字母或数字）
print("   ".isspace())     # True（全是空格）
print("Hello".isupper())   # False
print("hello".islower())   # True
```

### 分割和连接

```python
# 分割
text = "apple,banana,orange"
fruits = text.split(",")
print(fruits)  # ['apple', 'banana', 'orange']

# 按行分割
text = "第一行\n第二行\n第三行"
lines = text.splitlines()
print(lines)  # ['第一行', '第二行', '第三行']

# 连接
fruits = ['apple', 'banana', 'orange']
text = ",".join(fruits)
print(text)  # apple,banana,orange

text = " | ".join(fruits)
print(text)  # apple | banana | orange
```

### 去除空格

```python
text = "  Hello World  "

print(text.strip())   # "Hello World"（两端）
print(text.lstrip())  # "Hello World  "（左端）
print(text.rstrip())  # "  Hello World"（右端）

# 去除指定字符
text = "***Hello***"
print(text.strip("*"))  # "Hello"
```

### 对齐

```python
text = "Python"

print(text.center(20))     # "       Python       "
print(text.center(20, "*"))  # "*******Python*******"
print(text.ljust(20, "-"))   # "Python--------------"
print(text.rjust(20, "-"))   # "--------------Python"
```

## 字符串是不可变的

```python
text = "Hello"

# 不能修改单个字符
# text[0] = "h"  # TypeError!

# 只能创建新字符串
text = "h" + text[1:]
print(text)  # hello

# 或者
text = text.replace("H", "h")
```

## 实战例子

### 例子1：验证密码强度

```python
password = input("请输入密码：")

# 检查长度
if len(password) < 8:
    print("密码太短，至少8位")
elif not any(c.isdigit() for c in password):
    print("密码必须包含数字")
elif not any(c.isalpha() for c in password):
    print("密码必须包含字母")
elif password.islower() or password.isupper():
    print("密码必须包含大小写字母")
else:
    print("密码强度：强")
```

### 例子2：格式化输出表格

```python
# 学生成绩表
students = [
    ("张三", 90, 85, 92),
    ("李四", 88, 92, 87),
    ("王五", 95, 89, 91)
]

print("姓名\t语文\t数学\t英语\t平均分")
print("-" * 40)

for name, chinese, math, english in students:
    avg = (chinese + math + english) / 3
    print(f"{name}\t{chinese}\t{math}\t{english}\t{avg:.1f}")
```

### 例子3：提取文件名和扩展名

```python
filename = "document.pdf"

# 方法1：split
name, ext = filename.rsplit(".", 1)
print(f"文件名：{name}")  # document
print(f"扩展名：{ext}")  # pdf

# 方法2：rfind
dot_index = filename.rfind(".")
name = filename[:dot_index]
ext = filename[dot_index+1:]
```

### 例子4：敏感词过滤

```python
text = "这是一条包含敏感词的评论"
sensitive_words = ["敏感词", "不良信息", "违规"]

# 替换敏感词
for word in sensitive_words:
    text = text.replace(word, "*" * len(word))

print(text)  # 这是一条包含***的评论
```

### 例子5：简单的文本分析

```python
text = input("输入一段文字：")

print(f"字符总数：{len(text)}")
print(f"单词数量：{len(text.split())}")
print(f"字母数量：{sum(c.isalpha() for c in text)}")
print(f"数字数量：{sum(c.isdigit() for c in text)}")
print(f"空格数量：{text.count(' ')}")
```

## 常见陷阱

### 陷阱1：字符串是不可变的

```python
text = "Hello"
# text[0] = "h"  # 错误！

# 正确：创建新字符串
text = text.replace("H", "h")
```

### 陷阱2：字符串乘法

```python
print("=" * 50)  # 50个等号，很方便
```

### 陷阱3：多行字符串的缩进

```python
# 错误：缩进也会被包含
text = """
    第一行
    第二行
    """
print(text)  # 输出会有很多空格

# 正确：
text = """
第一行
第二行
""".strip()
```

## 练习题

### 练习1：回文判断

判断一个字符串是否是回文（正着读和倒着读一样）。

```python
# 示例：
# "level" → True
# "hello" → False
```

### 练习2：单词统计

输入一段文字，统计每个单词出现的次数。

### 练习3：凯撒密码

实现凯撒密码加密：把每个字母向后移动3位（a→d, b→e）。

### 练习4：格式化手机号

把手机号格式化成 xxx-xxxx-xxxx 的形式。

```python
# 输入：13812345678
# 输出：138-1234-5678
```

## 下一步

学会了字符串操作，下一章我们学习列表（List），Python最常用的数据结构！

[上一章：第04章 - 数字类型和运算 ←](../04-数字类型和运算/04-数字类型和运算.md)

[下一章：第06章 - 列表 →](../06-列表/06-列表.md)

---

**本章重点**
- ✅ 字符串的创建方式
- ✅ 索引和切片
- ✅ f-string格式化输出
- ✅ 常用字符串方法
- ✅ 字符串是不可变的

**记住**
- 字符串索引从0开始
- 切片不包括结束位置
- 字符串不可变，只能创建新字符串
- f-string是最推荐的格式化方式
- [::-1]可以反转字符串
