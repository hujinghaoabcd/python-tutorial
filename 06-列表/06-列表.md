# 第06章：列表（List）

列表是Python中最常用的数据结构，可以装任何类型的数据。简单来说，列表就是一个有序的容器，可以存储多个元素，并且可以随时添加、删除、修改其中的元素。

在日常生活中，我们经常需要处理一组相关的数据：购物清单、学生名单、成绩列表等等。Python的列表就是为了解决这类问题而设计的，它功能强大、使用灵活，是Python编程中不可或缺的工具。

---

## 什么是列表？

列表就像一个购物袋，可以装很多东西。你可以往里面放任何东西：数字、文字、甚至其他列表。列表中的元素是有顺序的，每个元素都有一个位置编号（索引），从0开始计数。

**理解列表**：可以把列表想象成一排带编号的盒子，每个盒子可以放一个元素。你可以随时查看、修改、添加或删除盒子里的内容。

```python
# 空列表
empty_list = []

# 数字列表
numbers = [1, 2, 3, 4, 5]

# 字符串列表
fruits = ["苹果", "香蕉", "橙子"]

# 混合类型（不推荐，但可以）
mixed = [1, "hello", 3.14, True, [1, 2, 3]]
```

**列表的特点**：
- 有序：元素按照添加的顺序排列
- 可变：可以随时修改、添加、删除元素
- 可重复：同一个元素可以出现多次
- 灵活：可以存储任何类型的数据

---

## 创建列表

在Python中，有多种方式可以创建列表。不同的方式适用于不同的场景，选择合适的方式可以让代码更简洁高效。

---

### 直接创建

最直接的方式就是用方括号 `[]` 把元素包起来，元素之间用逗号分隔。这是最常用的创建方式。

```python
# 方括号创建
fruits = ["苹果", "香蕉", "橙子"]

# list()函数
numbers = list(range(1, 6))  # [1, 2, 3, 4, 5]
chars = list("Python")  # ['P', 'y', 't', 'h', 'o', 'n']
```

**使用场景**：当你已经知道要存储哪些元素时，直接用方括号创建最方便。`list()` 函数常用于将其他可迭代对象（如字符串、range对象）转换成列表。

---

### 列表推导式（后面会详细讲）

列表推导式是一种简洁的创建列表的方式，特别适合根据某种规则生成列表。它的语法简洁，执行效率也较高。

```python
# 生成1-10的平方
squares = [x**2 for x in range(1, 11)]
# [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
```

**优势**：列表推导式比传统的循环+append方式更简洁，代码可读性更强。适合生成有规律的列表。

---

## 访问列表元素

创建了列表之后，我们需要能够访问其中的元素。Python提供了索引和切片两种方式来访问列表元素，这和字符串的访问方式非常相似。

---

### 索引

索引就是通过位置编号来访问列表中的某个元素。Python中的索引从0开始，也就是说第一个元素的索引是0，第二个元素的索引是1，以此类推。Python还支持负数索引，从-1开始表示最后一个元素。

```python
fruits = ["苹果", "香蕉", "橙子", "葡萄"]

# 正向索引（从0开始）
print(fruits[0])   # 苹果
print(fruits[1])   # 香蕉

# 反向索引（从-1开始）
print(fruits[-1])  # 葡萄（最后一个）
print(fruits[-2])  # 橙子

# 越界会报错
# print(fruits[10])  # IndexError
```

**理解索引**：列表的索引和字符串的索引完全一样，都是从0开始。正向索引从左边开始编号，负向索引从右边开始编号。记住索引从0开始，这是很多初学者容易混淆的地方。

---

### 切片

切片就是获取列表的一部分，通过指定起始位置和结束位置来截取子列表。切片的基本语法是 `[起始:结束]`，注意结束位置是不包含的。切片还支持步长参数，可以每隔几个元素取一个。

```python
numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

# [起始:结束]（不包括结束位置）
print(numbers[2:5])    # [2, 3, 4]
print(numbers[:3])     # [0, 1, 2]（前3个）
print(numbers[7:])     # [7, 8, 9]（从索引7到末尾）
print(numbers[:])      # 复制整个列表

# 步长
print(numbers[::2])    # [0, 2, 4, 6, 8]（每隔2个）
print(numbers[1::2])   # [1, 3, 5, 7, 9]（奇数位）
print(numbers[::-1])   # [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]（反转）
```

**切片规则**：切片遵循"左闭右开"原则，即包含起始位置，但不包含结束位置。这和字符串的切片规则完全一致。切片会返回一个新的列表，不会修改原列表。

---

## 修改列表

列表是可变的（mutable），这是列表和字符串最重要的区别。你可以随时修改列表中的元素，添加新元素，或者删除不需要的元素。这种灵活性让列表成为处理动态数据的最佳选择。

---

### 修改单个元素

修改单个元素非常简单，只需要通过索引找到要修改的元素，然后给它赋一个新值就可以了。

```python
fruits = ["苹果", "香蕉", "橙子"]
fruits[0] = "西瓜"
print(fruits)  # ['西瓜', '香蕉', '橙子']
```

**注意事项**：修改元素时要注意索引不能越界。如果索引超出了列表的范围，会抛出IndexError异常。

---

### 修改多个元素

通过切片可以一次性修改多个元素。只需要把切片赋值给一个新的列表，就可以替换掉切片范围内的所有元素。

```python
numbers = [1, 2, 3, 4, 5]
numbers[1:3] = [20, 30]
print(numbers)  # [1, 20, 30, 4, 5]
```

**灵活应用**：切片赋值时，新列表的长度可以和原切片长度不同。如果新列表更长，列表会变长；如果新列表更短，列表会变短。这给了我们很大的灵活性。

---

## 添加元素

向列表中添加元素是最常用的操作之一。Python提供了三种方法来添加元素：`append()` 在末尾添加，`insert()` 在指定位置插入，`extend()` 添加多个元素。

---

### append() - 末尾添加

`append()` 方法是最常用的添加元素的方法，它总是在列表的末尾添加一个新元素。这是最快速、最高效的添加方式。

```python
fruits = ["苹果", "香蕉"]
fruits.append("橙子")
print(fruits)  # ['苹果', '香蕉', '橙子']

# 一次只能加一个
fruits.append("葡萄")
print(fruits)  # ['苹果', '香蕉', '橙子', '葡萄']
```

**使用场景**：当你需要逐个添加元素时，`append()` 是最佳选择。比如从用户输入中收集数据，或者从文件中读取数据时，通常使用 `append()` 方法。

---

### insert() - 指定位置插入

`insert()` 方法可以在列表的任意位置插入一个新元素。它需要两个参数：插入位置的索引和要插入的元素。

```python
fruits = ["苹果", "香蕉", "橙子"]
fruits.insert(1, "西瓜")  # 在索引1的位置插入
print(fruits)  # ['苹果', '西瓜', '香蕉', '橙子']
```

**注意事项**：`insert()` 方法会把新元素插入到指定位置，原来在该位置及之后的元素会向后移动。如果索引超出范围，新元素会被插入到列表末尾。

---

### extend() - 添加多个元素

`extend()` 方法可以一次性添加多个元素。它接受一个可迭代对象（如列表、元组等），把其中的所有元素都添加到列表末尾。

```python
fruits = ["苹果", "香蕉"]
more_fruits = ["橙子", "葡萄"]
fruits.extend(more_fruits)
print(fruits)  # ['苹果', '香蕉', '橙子', '葡萄']

# 或者用 +
fruits = ["苹果", "香蕉"]
fruits = fruits + ["橙子", "葡萄"]
print(fruits)  # ['苹果', '香蕉', '橙子', '葡萄']
```

**extend vs +**：`extend()` 方法会修改原列表，而 `+` 运算符会创建一个新列表。如果不需要保留原列表，使用 `extend()` 更高效；如果需要保留原列表，使用 `+` 更合适。

---

## 删除元素

删除元素是列表操作的另一个重要部分。Python提供了多种删除元素的方法，每种方法适用于不同的场景。

---

### del - 按索引删除

`del` 是Python的关键字，可以用来删除列表中的元素。它可以删除单个元素，也可以删除一个切片范围内的所有元素。

```python
fruits = ["苹果", "香蕉", "橙子", "葡萄"]
del fruits[1]  # 删除索引1的元素
print(fruits)  # ['苹果', '橙子', '葡萄']

# 删除切片
numbers = [1, 2, 3, 4, 5]
del numbers[1:3]
print(numbers)  # [1, 4, 5]
```

**使用场景**：当你明确知道要删除元素的索引位置时，使用 `del` 最直接。`del` 也可以删除整个变量，让变量名不再指向任何对象。

---

### remove() - 按值删除

`remove()` 方法根据元素的值来删除元素。它会删除列表中第一个匹配的元素。如果列表中有多个相同的元素，只会删除第一个。

```python
fruits = ["苹果", "香蕉", "橙子", "香蕉"]
fruits.remove("香蕉")  # 删除第一个"香蕉"
print(fruits)  # ['苹果', '橙子', '香蕉']

# 如果元素不存在会报错
# fruits.remove("西瓜")  # ValueError
```

**注意事项**：`remove()` 方法在找不到要删除的元素时会抛出ValueError异常。在使用前最好先用 `in` 关键字检查元素是否存在。

---

### pop() - 弹出元素

`pop()` 方法会删除并返回列表中的一个元素。如果不指定索引，默认删除并返回最后一个元素；如果指定了索引，则删除并返回该位置的元素。

```python
fruits = ["苹果", "香蕉", "橙子"]

# 不带参数，删除并返回最后一个
last = fruits.pop()
print(last)    # 橙子
print(fruits)  # ['苹果', '香蕉']

# 带参数，删除并返回指定位置
first = fruits.pop(0)
print(first)   # 苹果
print(fruits)  # ['香蕉']
```

**使用场景**：`pop()` 方法常用于实现栈（后进先出）或队列（先进先出）数据结构。当你需要删除元素的同时还要使用这个元素的值时，`pop()` 是最佳选择。

---

### clear() - 清空列表

`clear()` 方法会删除列表中的所有元素，让列表变成空列表。这个方法不会删除列表本身，只是清空其中的内容。

```python
fruits = ["苹果", "香蕉", "橙子"]
fruits.clear()
print(fruits)  # []
```

**使用场景**：当你需要重置列表，但还要保留列表对象时，使用 `clear()` 方法。如果不再需要这个列表，可以直接重新赋值一个空列表 `[]`。

---

## 列表操作

除了添加和删除元素，列表还支持很多其他操作：查找元素、排序、反转等等。这些操作让列表的功能更加强大。

---

### 查找

查找是列表操作中最常用的功能之一。Python提供了 `index()`、`count()` 和 `in` 关键字来实现查找功能。

```python
fruits = ["苹果", "香蕉", "橙子", "香蕉"]

# 查找索引
print(fruits.index("香蕉"))  # 1（第一次出现的位置）

# 计数
print(fruits.count("香蕉"))  # 2

# 判断是否存在
print("苹果" in fruits)  # True
print("西瓜" in fruits)  # False
```

**查找方法**：
- `index()` 返回元素第一次出现的索引，如果元素不存在会抛出异常
- `count()` 返回元素在列表中出现的次数
- `in` 关键字用于判断元素是否存在，返回True或False

---

### 排序

排序是处理列表数据时经常需要的操作。Python提供了 `sort()` 方法和 `sorted()` 函数来实现排序功能。

```python
# sort() - 原地排序（修改原列表）
numbers = [3, 1, 4, 1, 5, 9, 2]
numbers.sort()
print(numbers)  # [1, 1, 2, 3, 4, 5, 9]

# 降序
numbers.sort(reverse=True)
print(numbers)  # [9, 5, 4, 3, 2, 1, 1]

# sorted() - 返回新列表（不修改原列表）
numbers = [3, 1, 4, 1, 5]
sorted_numbers = sorted(numbers)
print(numbers)  # [3, 1, 4, 1, 5]（原列表不变）
print(sorted_numbers)  # [1, 1, 3, 4, 5]
```

**sort vs sorted**：
- `sort()` 是列表的方法，会修改原列表，不返回值
- `sorted()` 是内置函数，不修改原列表，返回一个新的排序后的列表
- 如果需要保留原列表，使用 `sorted()`；如果不需要保留原列表，使用 `sort()` 更高效

---

### 反转

反转列表就是把列表中的元素顺序颠倒过来。Python提供了 `reverse()` 方法和切片两种方式来实现反转。

```python
fruits = ["苹果", "香蕉", "橙子"]

# reverse() - 原地反转
fruits.reverse()
print(fruits)  # ['橙子', '香蕉', '苹果']

# 或者用切片（返回新列表）
fruits = ["苹果", "香蕉", "橙子"]
reversed_fruits = fruits[::-1]
print(reversed_fruits)  # ['橙子', '香蕉', '苹果']
```

**反转方法**：
- `reverse()` 方法会修改原列表，不返回值
- 切片 `[::-1]` 会返回一个新的反转后的列表，不修改原列表
- 如果需要保留原列表，使用切片；如果不需要保留原列表，使用 `reverse()` 更高效

---

### 其他操作

除了上述操作，列表还支持很多其他有用的操作：获取长度、求最大值最小值、求和、复制列表等等。

```python
numbers = [1, 2, 3, 4, 5]

# 长度
print(len(numbers))  # 5

# 最大值、最小值、求和
print(max(numbers))  # 5
print(min(numbers))  # 1
print(sum(numbers))  # 15

# 复制列表
copy1 = numbers.copy()
copy2 = numbers[:]
copy3 = list(numbers)
```

**复制列表**：Python提供了三种复制列表的方式：`copy()` 方法、切片 `[:]`、`list()` 函数。这三种方式都是浅拷贝，对于包含可变对象的列表，需要注意浅拷贝和深拷贝的区别。

---

## 列表遍历

遍历列表就是依次访问列表中的每个元素。这是处理列表数据时最常用的操作。Python提供了多种遍历方式，每种方式适用于不同的场景。

---

### for循环

`for` 循环是遍历列表最常用的方式。Python提供了多种 `for` 循环的写法，可以遍历元素、遍历索引、或者同时遍历索引和元素。

```python
fruits = ["苹果", "香蕉", "橙子"]

# 遍历元素
for fruit in fruits:
    print(fruit)

# 遍历索引和元素
for i, fruit in enumerate(fruits):
    print(f"{i}: {fruit}")

# 遍历索引
for i in range(len(fruits)):
    print(f"{i}: {fruits[i]}")
```

**遍历方式**：
- 直接遍历元素：当你只需要元素的值时使用
- `enumerate()` 函数：当你需要同时使用索引和元素时使用，这是最推荐的方式
- `range(len())`：当你需要修改元素时使用，但通常不推荐，因为可以用 `enumerate()` 替代

---

## 列表嵌套（二维列表）

列表可以包含任何类型的数据，包括其他列表。当一个列表的元素也是列表时，就形成了嵌套列表，也叫二维列表。二维列表常用于表示矩阵、表格等二维数据结构。

```python
# 矩阵
matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
]

# 访问元素
print(matrix[0][0])  # 1
print(matrix[1][2])  # 6

# 遍历二维列表
for row in matrix:
    for item in row:
        print(item, end=" ")
    print()  # 换行
```

**理解嵌套**：二维列表就像是一个表格，第一个索引表示行，第二个索引表示列。访问元素时，先找到行，再找到列。遍历时通常使用嵌套循环：外层循环遍历行，内层循环遍历列。

---

## 实战例子

理论知识学完了，让我们通过一些实际的例子来巩固所学内容。这些例子都是日常编程中经常遇到的问题，掌握它们对提高编程能力很有帮助。

---

### 例子1：成绩管理

成绩管理是学校管理系统中常见的功能。这个例子展示了如何使用列表来存储和管理学生成绩，并进行统计分析。

**实现思路**：使用 `append()` 方法收集成绩，使用 `sum()`、`max()`、`min()` 等函数进行统计分析。这个例子展示了列表在数据收集和统计中的应用。

```python
# 学生成绩列表
scores = []

# 输入成绩
while True:
    score = input("输入成绩（输入q退出）：")
    if score == 'q':
        break
    scores.append(float(score))

# 统计
if scores:
    print(f"\n总分：{sum(scores)}")
    print(f"平均分：{sum(scores) / len(scores):.2f}")
    print(f"最高分：{max(scores)}")
    print(f"最低分：{min(scores)}")
    print(f"成绩个数：{len(scores)}")
```

---

### 例子2：待办事项列表

待办事项列表是任务管理应用的核心功能。这个例子展示了如何使用列表来实现一个简单的待办事项管理系统。

**实现思路**：使用 `append()` 添加任务，使用 `enumerate()` 显示任务列表，使用 `pop()` 完成任务。这个例子展示了列表在交互式应用中的应用。

```python
todo_list = []

while True:
    print("\n=== 待办事项 ===")
    print("1. 添加任务")
    print("2. 查看任务")
    print("3. 完成任务")
    print("4. 退出")

    choice = input("选择操作：")

    if choice == "1":
        task = input("输入任务：")
        todo_list.append(task)
        print("任务已添加！")
    elif choice == "2":
        if todo_list:
            for i, task in enumerate(todo_list, 1):
                print(f"{i}. {task}")
        else:
            print("暂无任务")
    elif choice == "3":
        if todo_list:
            for i, task in enumerate(todo_list, 1):
                print(f"{i}. {task}")
            num = int(input("完成第几个任务？")) - 1
            if 0 <= num < len(todo_list):
                completed = todo_list.pop(num)
                print(f"完成：{completed}")
        else:
            print("暂无任务")
    elif choice == "4":
        break
```

---

### 例子3：数字去重

去重是数据处理中常见的操作。这个例子展示了两种去重的方法：使用集合（简单但不保持顺序）和保持顺序的去重方法。

**实现思路**：方法1使用集合的特性自动去重，但会丢失顺序；方法2通过遍历和判断来去重，可以保持原有顺序。这个例子展示了不同方法的选择。

```python
numbers = [1, 2, 2, 3, 3, 3, 4, 4, 5]

# 方法1：用集合
unique = list(set(numbers))
print(unique)  # [1, 2, 3, 4, 5]

# 方法2：保持顺序
unique = []
for num in numbers:
    if num not in unique:
        unique.append(num)
print(unique)  # [1, 2, 3, 4, 5]
```

---

### 例子4：简单的购物车

购物车是电商应用的核心功能。这个例子展示了如何使用列表来实现一个简单的购物车系统。

**实现思路**：使用列表存储购物车中的商品，使用字典存储商品信息。这个例子展示了列表和字典的配合使用。

```python
cart = []

# 商品数据库
products = {
    1: ("苹果", 5.0),
    2: ("香蕉", 3.0),
    3: ("橙子", 4.0)
}

while True:
    print("\n=== 商品列表 ===")
    for id, (name, price) in products.items():
        print(f"{id}. {name} - ¥{price}")

    choice = input("\n选择商品（输入0结账）：")

    if choice == "0":
        break

    id = int(choice)
    if id in products:
        cart.append(products[id])
        print(f"已添加：{products[id][0]}")

# 结账
if cart:
    print("\n=== 购物车 ===")
    total = 0
    for name, price in cart:
        print(f"{name}: ¥{price}")
        total += price
    print(f"\n总计：¥{total}")
```

---

### 例子5：找出重复元素

找出列表中的重复元素是数据分析中常见的需求。这个例子展示了如何找出所有重复的元素。

**实现思路**：使用两个列表来跟踪已见过的元素和重复的元素。遍历列表，如果元素已经见过且不在重复列表中，就添加到重复列表。这个例子展示了列表在数据分析中的应用。

```python
numbers = [1, 2, 3, 2, 4, 3, 5, 1]

# 找出所有重复的元素
duplicates = []
seen = []

for num in numbers:
    if num in seen and num not in duplicates:
        duplicates.append(num)
    seen.append(num)

print(f"重复的元素：{duplicates}")
```

---

## 列表常见操作总结

为了方便查阅，这里总结了列表的常用操作。记住这些操作，可以大大提高编程效率。

```python
# 创建
lst = [1, 2, 3]

# 添加
lst.append(4)      # 末尾添加
lst.insert(0, 0)   # 指定位置插入
lst.extend([5, 6]) # 添加多个

# 删除
lst.remove(3)      # 按值删除
lst.pop()          # 删除末尾
lst.pop(0)         # 删除指定位置
del lst[1]         # 按索引删除
lst.clear()        # 清空

# 查找
lst.index(2)       # 查找索引
lst.count(2)       # 计数
2 in lst           # 是否存在

# 排序
lst.sort()         # 原地排序
sorted(lst)        # 返回新列表

# 反转
lst.reverse()      # 原地反转
lst[::-1]          # 返回新列表

# 其他
len(lst)           # 长度
max(lst)           # 最大值
min(lst)           # 最小值
sum(lst)           # 求和
```

---

## 常见错误

在学习列表操作时，有一些常见的错误和陷阱需要注意。了解这些错误可以帮助你避免犯错，写出更健壮的代码。

---

### 错误1：索引越界

索引越界是初学者最容易犯的错误。当你试图访问一个不存在的索引时，Python会抛出IndexError异常。

```python
fruits = ["苹果", "香蕉"]
# print(fruits[5])  # IndexError

# 安全访问
if len(fruits) > 5:
    print(fruits[5])
else:
    print("索引超出范围")
```

**避免方法**：在访问索引之前，先检查索引是否在有效范围内。可以使用 `len()` 函数获取列表长度，或者使用 `try-except` 语句捕获异常。

---

### 错误2：循环中修改列表

在循环中修改列表是一个危险的陷阱。当你边遍历边删除元素时，可能会导致某些元素被跳过，或者索引错乱。

```python
# 错误
numbers = [1, 2, 3, 4, 5]
for num in numbers:
    if num % 2 == 0:
        numbers.remove(num)  # 危险！

# 正确
numbers = [1, 2, 3, 4, 5]
numbers = [num for num in numbers if num % 2 != 0]
```

**解决方法**：不要在遍历列表的同时修改列表。如果需要删除元素，可以使用列表推导式创建一个新列表，或者倒序遍历列表。

---

### 错误3：浅拷贝陷阱

列表赋值是引用赋值，不是复制。如果你把一个列表赋值给另一个变量，两个变量会指向同一个列表对象。修改其中一个，另一个也会跟着改变。

```python
# 错误
a = [1, 2, 3]
b = a  # b和a指向同一个列表
b.append(4)
print(a)  # [1, 2, 3, 4]，a也变了！

# 正确
a = [1, 2, 3]
b = a.copy()  # 或 a[:] 或 list(a)
b.append(4)
print(a)  # [1, 2, 3]，a没变
```

**解决方法**：如果需要复制列表，使用 `copy()` 方法、切片 `[:]` 或 `list()` 函数。注意这些都是浅拷贝，对于包含可变对象的列表，可能需要深拷贝。

---

## 练习题

理论知识学完了，通过练习来巩固所学内容。这些练习题由易到难，涵盖了列表操作的主要知识点。

---

### 练习1：列表反转

不使用reverse()方法，实现列表反转。

**提示**：可以使用切片，或者使用循环从后往前遍历。

---

### 练习2：找出最大和最小

不使用max()和min()，找出列表中的最大值和最小值。

**提示**：遍历列表，用变量记录当前的最大值和最小值。

---

### 练习3：移除重复元素

保持原有顺序，移除列表中的重复元素。

**提示**：遍历列表，使用一个新列表来存储不重复的元素。

---

### 练习4：合并两个有序列表

将两个已排序的列表合并成一个有序列表。

**提示**：使用两个指针分别指向两个列表，比较指针位置的元素，将较小的元素添加到结果列表中。

---

### 练习5：二维列表转置

将矩阵转置（行列互换）。

```python
# 输入：
# [[1, 2, 3],
#  [4, 5, 6]]
# 输出：
# [[1, 4],
#  [2, 5],
#  [3, 6]]
```

**提示**：使用嵌套循环，外层循环遍历列，内层循环遍历行。

---

## 下一步

学会了列表，下一章我们学习元组（Tuple），一种不可变的列表！元组和列表非常相似，但元组是不可变的，这使得它在某些场景下比列表更合适。

[上一章：第05章 - 字符串详解 ←](../05-字符串详解/05-字符串详解.md)

[下一章：第07章 - 元组 →](../07-元组/07-元组.md)

---

**本章重点**
- 列表是可变的数据结构
- 索引从0开始，负索引从-1开始
- 切片操作[起始:结束:步长]
- append、insert、extend添加元素
- remove、pop、del删除元素
- sort排序、reverse反转

**记住**
- 列表可以包含任何类型的数据
- 列表是可变的（可以修改）
- 索引越界会报错
- 循环中修改列表要小心
- 列表赋值是引用，不是复制
