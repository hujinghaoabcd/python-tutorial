# 第06章：列表（List）

列表是Python中最常用的数据结构，可以装任何类型的数据。

## 什么是列表？

列表就像一个购物袋，可以装很多东西。

```python
# 空列表
empty_list = []

# 数字列表
numbers = [1, 2, 3, 4, 5]

# 字符串列表
fruits = ["苹果", "香蕉", "橙子"]

# 混合类型（不推荐，但可以）
mixed = [1, "hello", 3.14, True, [1, 2, 3]]
```

## 创建列表

### 直接创建

```python
# 方括号创建
fruits = ["苹果", "香蕉", "橙子"]

# list()函数
numbers = list(range(1, 6))  # [1, 2, 3, 4, 5]
chars = list("Python")  # ['P', 'y', 't', 'h', 'o', 'n']
```

### 列表推导式（后面会详细讲）

```python
# 生成1-10的平方
squares = [x**2 for x in range(1, 11)]
# [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
```

## 访问列表元素

### 索引

```python
fruits = ["苹果", "香蕉", "橙子", "葡萄"]

# 正向索引（从0开始）
print(fruits[0])   # 苹果
print(fruits[1])   # 香蕉

# 反向索引（从-1开始）
print(fruits[-1])  # 葡萄（最后一个）
print(fruits[-2])  # 橙子

# 越界会报错
# print(fruits[10])  # IndexError
```

### 切片

```python
numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

# [起始:结束]（不包括结束位置）
print(numbers[2:5])    # [2, 3, 4]
print(numbers[:3])     # [0, 1, 2]（前3个）
print(numbers[7:])     # [7, 8, 9]（从索引7到末尾）
print(numbers[:])      # 复制整个列表

# 步长
print(numbers[::2])    # [0, 2, 4, 6, 8]（每隔2个）
print(numbers[1::2])   # [1, 3, 5, 7, 9]（奇数位）
print(numbers[::-1])   # [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]（反转）
```

## 修改列表

列表是可变的（mutable），可以修改。

### 修改单个元素

```python
fruits = ["苹果", "香蕉", "橙子"]
fruits[0] = "西瓜"
print(fruits)  # ['西瓜', '香蕉', '橙子']
```

### 修改多个元素

```python
numbers = [1, 2, 3, 4, 5]
numbers[1:3] = [20, 30]
print(numbers)  # [1, 20, 30, 4, 5]
```

## 添加元素

### append() - 末尾添加

```python
fruits = ["苹果", "香蕉"]
fruits.append("橙子")
print(fruits)  # ['苹果', '香蕉', '橙子']

# 一次只能加一个
fruits.append("葡萄")
print(fruits)  # ['苹果', '香蕉', '橙子', '葡萄']
```

### insert() - 指定位置插入

```python
fruits = ["苹果", "香蕉", "橙子"]
fruits.insert(1, "西瓜")  # 在索引1的位置插入
print(fruits)  # ['苹果', '西瓜', '香蕉', '橙子']
```

### extend() - 添加多个元素

```python
fruits = ["苹果", "香蕉"]
more_fruits = ["橙子", "葡萄"]
fruits.extend(more_fruits)
print(fruits)  # ['苹果', '香蕉', '橙子', '葡萄']

# 或者用 +
fruits = ["苹果", "香蕉"]
fruits = fruits + ["橙子", "葡萄"]
print(fruits)  # ['苹果', '香蕉', '橙子', '葡萄']
```

## 删除元素

### del - 按索引删除

```python
fruits = ["苹果", "香蕉", "橙子", "葡萄"]
del fruits[1]  # 删除索引1的元素
print(fruits)  # ['苹果', '橙子', '葡萄']

# 删除切片
numbers = [1, 2, 3, 4, 5]
del numbers[1:3]
print(numbers)  # [1, 4, 5]
```

### remove() - 按值删除

```python
fruits = ["苹果", "香蕉", "橙子", "香蕉"]
fruits.remove("香蕉")  # 删除第一个"香蕉"
print(fruits)  # ['苹果', '橙子', '香蕉']

# 如果元素不存在会报错
# fruits.remove("西瓜")  # ValueError
```

### pop() - 弹出元素

```python
fruits = ["苹果", "香蕉", "橙子"]

# 不带参数，删除并返回最后一个
last = fruits.pop()
print(last)    # 橙子
print(fruits)  # ['苹果', '香蕉']

# 带参数，删除并返回指定位置
first = fruits.pop(0)
print(first)   # 苹果
print(fruits)  # ['香蕉']
```

### clear() - 清空列表

```python
fruits = ["苹果", "香蕉", "橙子"]
fruits.clear()
print(fruits)  # []
```

## 列表操作

### 查找

```python
fruits = ["苹果", "香蕉", "橙子", "香蕉"]

# 查找索引
print(fruits.index("香蕉"))  # 1（第一次出现的位置）

# 计数
print(fruits.count("香蕉"))  # 2

# 判断是否存在
print("苹果" in fruits)  # True
print("西瓜" in fruits)  # False
```

### 排序

```python
# sort() - 原地排序（修改原列表）
numbers = [3, 1, 4, 1, 5, 9, 2]
numbers.sort()
print(numbers)  # [1, 1, 2, 3, 4, 5, 9]

# 降序
numbers.sort(reverse=True)
print(numbers)  # [9, 5, 4, 3, 2, 1, 1]

# sorted() - 返回新列表（不修改原列表）
numbers = [3, 1, 4, 1, 5]
sorted_numbers = sorted(numbers)
print(numbers)  # [3, 1, 4, 1, 5]（原列表不变）
print(sorted_numbers)  # [1, 1, 3, 4, 5]
```

### 反转

```python
fruits = ["苹果", "香蕉", "橙子"]

# reverse() - 原地反转
fruits.reverse()
print(fruits)  # ['橙子', '香蕉', '苹果']

# 或者用切片（返回新列表）
fruits = ["苹果", "香蕉", "橙子"]
reversed_fruits = fruits[::-1]
print(reversed_fruits)  # ['橙子', '香蕉', '苹果']
```

### 其他操作

```python
numbers = [1, 2, 3, 4, 5]

# 长度
print(len(numbers))  # 5

# 最大值、最小值、求和
print(max(numbers))  # 5
print(min(numbers))  # 1
print(sum(numbers))  # 15

# 复制列表
copy1 = numbers.copy()
copy2 = numbers[:]
copy3 = list(numbers)
```

## 列表遍历

### for循环

```python
fruits = ["苹果", "香蕉", "橙子"]

# 遍历元素
for fruit in fruits:
    print(fruit)

# 遍历索引和元素
for i, fruit in enumerate(fruits):
    print(f"{i}: {fruit}")

# 遍历索引
for i in range(len(fruits)):
    print(f"{i}: {fruits[i]}")
```

## 列表嵌套（二维列表）

```python
# 矩阵
matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
]

# 访问元素
print(matrix[0][0])  # 1
print(matrix[1][2])  # 6

# 遍历二维列表
for row in matrix:
    for item in row:
        print(item, end=" ")
    print()  # 换行
```

## 实战例子

### 例子1：成绩管理

```python
# 学生成绩列表
scores = []

# 输入成绩
while True:
    score = input("输入成绩（输入q退出）：")
    if score == 'q':
        break
    scores.append(float(score))

# 统计
if scores:
    print(f"\n总分：{sum(scores)}")
    print(f"平均分：{sum(scores) / len(scores):.2f}")
    print(f"最高分：{max(scores)}")
    print(f"最低分：{min(scores)}")
    print(f"成绩个数：{len(scores)}")
```

### 例子2：待办事项列表

```python
todo_list = []

while True:
    print("\n=== 待办事项 ===")
    print("1. 添加任务")
    print("2. 查看任务")
    print("3. 完成任务")
    print("4. 退出")

    choice = input("选择操作：")

    if choice == "1":
        task = input("输入任务：")
        todo_list.append(task)
        print("任务已添加！")
    elif choice == "2":
        if todo_list:
            for i, task in enumerate(todo_list, 1):
                print(f"{i}. {task}")
        else:
            print("暂无任务")
    elif choice == "3":
        if todo_list:
            for i, task in enumerate(todo_list, 1):
                print(f"{i}. {task}")
            num = int(input("完成第几个任务？")) - 1
            if 0 <= num < len(todo_list):
                completed = todo_list.pop(num)
                print(f"完成：{completed}")
        else:
            print("暂无任务")
    elif choice == "4":
        break
```

### 例子3：数字去重

```python
numbers = [1, 2, 2, 3, 3, 3, 4, 4, 5]

# 方法1：用集合
unique = list(set(numbers))
print(unique)  # [1, 2, 3, 4, 5]

# 方法2：保持顺序
unique = []
for num in numbers:
    if num not in unique:
        unique.append(num)
print(unique)  # [1, 2, 3, 4, 5]
```

### 例子4：简单的购物车

```python
cart = []

# 商品数据库
products = {
    1: ("苹果", 5.0),
    2: ("香蕉", 3.0),
    3: ("橙子", 4.0)
}

while True:
    print("\n=== 商品列表 ===")
    for id, (name, price) in products.items():
        print(f"{id}. {name} - ¥{price}")

    choice = input("\n选择商品（输入0结账）：")

    if choice == "0":
        break

    id = int(choice)
    if id in products:
        cart.append(products[id])
        print(f"已添加：{products[id][0]}")

# 结账
if cart:
    print("\n=== 购物车 ===")
    total = 0
    for name, price in cart:
        print(f"{name}: ¥{price}")
        total += price
    print(f"\n总计：¥{total}")
```

### 例子5：找出重复元素

```python
numbers = [1, 2, 3, 2, 4, 3, 5, 1]

# 找出所有重复的元素
duplicates = []
seen = []

for num in numbers:
    if num in seen and num not in duplicates:
        duplicates.append(num)
    seen.append(num)

print(f"重复的元素：{duplicates}")
```

## 列表常见操作总结

```python
# 创建
lst = [1, 2, 3]

# 添加
lst.append(4)      # 末尾添加
lst.insert(0, 0)   # 指定位置插入
lst.extend([5, 6]) # 添加多个

# 删除
lst.remove(3)      # 按值删除
lst.pop()          # 删除末尾
lst.pop(0)         # 删除指定位置
del lst[1]         # 按索引删除
lst.clear()        # 清空

# 查找
lst.index(2)       # 查找索引
lst.count(2)       # 计数
2 in lst           # 是否存在

# 排序
lst.sort()         # 原地排序
sorted(lst)        # 返回新列表

# 反转
lst.reverse()      # 原地反转
lst[::-1]          # 返回新列表

# 其他
len(lst)           # 长度
max(lst)           # 最大值
min(lst)           # 最小值
sum(lst)           # 求和
```

## 常见错误

### 错误1：索引越界

```python
fruits = ["苹果", "香蕉"]
# print(fruits[5])  # IndexError

# 安全访问
if len(fruits) > 5:
    print(fruits[5])
```

### 错误2：循环中修改列表

```python
# 错误
numbers = [1, 2, 3, 4, 5]
for num in numbers:
    if num % 2 == 0:
        numbers.remove(num)  # 危险！

# 正确
numbers = [1, 2, 3, 4, 5]
numbers = [num for num in numbers if num % 2 != 0]
```

### 错误3：浅拷贝陷阱

```python
# 错误
a = [1, 2, 3]
b = a  # b和a指向同一个列表
b.append(4)
print(a)  # [1, 2, 3, 4]，a也变了！

# 正确
a = [1, 2, 3]
b = a.copy()  # 或 a[:] 或 list(a)
b.append(4)
print(a)  # [1, 2, 3]，a没变
```

## 练习题

### 练习1：列表反转

不使用reverse()方法，实现列表反转。

### 练习2：找出最大和最小

不使用max()和min()，找出列表中的最大值和最小值。

### 练习3：移除重复元素

保持原有顺序，移除列表中的重复元素。

### 练习4：合并两个有序列表

将两个已排序的列表合并成一个有序列表。

### 练习5：二维列表转置

将矩阵转置（行列互换）。

```python
# 输入：
# [[1, 2, 3],
#  [4, 5, 6]]
# 输出：
# [[1, 4],
#  [2, 5],
#  [3, 6]]
```

## 下一步

学会了列表，下一章我们学习元组（Tuple），一种不可变的列表！

[上一章：第05章 - 字符串详解 ←](../05-字符串详解/05-字符串详解.md)

[下一章：第07章 - 元组 →](../07-元组/07-元组.md)

---

**本章重点**
- ✅ 列表是可变的数据结构
- ✅ 索引从0开始，负索引从-1开始
- ✅ 切片操作[起始:结束:步长]
- ✅ append、insert、extend添加元素
- ✅ remove、pop、del删除元素
- ✅ sort排序、reverse反转

**记住**
- 列表可以包含任何类型的数据
- 列表是可变的（可以修改）
- 索引越界会报错
- 循环中修改列表要小心
- 列表赋值是引用，不是复制
